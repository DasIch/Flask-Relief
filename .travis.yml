language: python

python:
  - 2.6
  - 2.7
  - pypy
  - 3.3

env:
  - REQUIREMENTS=lowest PACKAGING=true
  - REQUIREMENTS=release PACKAGING=true
  - REQUIREMENTS=devel PACKAGING=true

matrix:
  exclude:
    - python: 2.6
      env: REQUIREMENTS=lowest PACKAGING=true
  include:
    - python: 2.6
      env: REQUIREMENTS=lowest

install:
  - pip install -r .travis-$REQUIREMENTS-requirements.txt
  - pip install --use-mirrors pytest pytest-cov tox coveralls sphinx
  - pip install .

script:
  - py.test --cov=flask_relief --cov=test_flask_relief.py
  - tox -e style
  # ensure that the docs stuff runs only once
  - python -c "import sys; sys.exit(sys.version_info[:2] == (2, 6))" || tox -e docs,docs3,docs-linkcheck
  - if [[ PACKAGING = true ]]; then tox -e packaging; fi

after_success:
  - coveralls
